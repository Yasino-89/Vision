<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£Ù†Ø§ ... Ø¥Ù†Ø³Ø§Ù† Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</title>
    <style>
        @font-face {
            font-family: 'HelveticaNeueLTArabic-Roman';
            src: url('HelveticaNeueLTArabic-Roman.ttf');
        }

        body {
            font-family: 'HelveticaNeueLTArabic-Roman', sans-serif;
            direction: rtl;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-image: url('1.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        .cover {
            text-align: center;
            padding: 40px;
            backdrop-filter: blur(5px);
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            transition: all 0.5s ease;
            width: 80%;
            max-width: 800px;
            margin: 20px;
            border: 1px solid #E5554D;
            position: relative;
        }

        .cover:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        h1, h2, h3 {
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: #247EB1;
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #934798;
        }

        h3 {
            font-size: 1.4rem;
            color: #247EB1;
            margin-top: 25px;
        }

        .inspiration {
            background-color: rgba(248, 205, 113, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-right: 3px solid #F8CD71;
            font-style: italic;
            color: #555;
        }

        textarea, input[type="text"] {
            width: 90%;
            padding: 15px;
            font-size: 16px;
            margin: 15px 0;
            border: 1px solid #86CDBB;
            border-radius: 10px;
            resize: vertical;
            transition: all 0.3s ease;
            background-color: rgba(255, 255, 255, 0.9);
            font-family: 'HelveticaNeueLTArabic-Roman', sans-serif;
        }

        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: #247EB1;
            box-shadow: 0 0 10px rgba(36, 126, 177, 0.2);
            transform: scale(1.01);
        }

        button {
            background-color: #247EB1;
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            font-family: 'HelveticaNeueLTArabic-Roman', sans-serif;
        }

        button:hover {
            background-color: #1a5a8a;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(0);
        }

        .small-btn {
            padding: 8px 15px;
            font-size: 14px;
            margin: 5px;
        }

        .youtube-video {
            width: 100%;
            max-width: 560px;
            height: 315px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .youtube-video:hover {
            transform: scale(1.01);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        #app {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            animation: fadeIn 0.5s ease;
        }

        .hidden {
            display: none;
        }

        .summary-box {
            background-color: rgba(134, 205, 187, 0.2);
            border-right: 5px solid #86CDBB;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .summary-box:hover {
            background-color: rgba(134, 205, 187, 0.3);
            transform: translateX(-5px);
        }

        .summary-title {
            font-weight: bold;
            color: #247EB1;
            margin-bottom: 10px;
        }

        .summary-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #247EB1;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.9);
            margin-top: 10px;
        }

        .vision-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            overflow: hidden;
        }

        .vision-table th {
            background-color: #F69C7A;
            color: white;
            padding: 12px;
            text-align: right;
        }

        .vision-table td {
            padding: 12px;
            border-bottom: 1px solid #F8CD71;
            text-align: right;
        }

        .vision-table tr:last-child td {
            border-bottom: none;
        }

        .vision-table tr:hover {
            background-color: rgba(134, 205, 187, 0.1);
        }

        .wish-item {
            background-color: rgba(230, 230, 250, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 3px solid #934798;
        }

        .wish-title {
            font-weight: bold;
            color: #934798;
            margin-bottom: 10px;
        }

        .footer {
            margin-top: 30px;
            padding: 15px;
            font-size: 0.9rem;
            color: #555;
            border-top: 1px solid #ddd;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .skill-input-container {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }

        .skill-input-container textarea {
            flex: 1;
            margin-right: 10px;
        }
    </style>
</head>

<body>
    <div id="app"></div>

    <script>
        const app = document.getElementById("app");
        const state = {
            currentStep: 0,
            userData: {
                name: "",
                definition: "",
                why: "",
                wishes: [],
                skills: [],
                needs: [],
                values: [],
                satisfaction: "",
                finalVision: "",
                shortSummary: ""
            }
        };

        const motivationalPhrases = {
            name: "ÙƒÙŠÙ ØªØ±Ù‰ Ù†ÙØ³Ùƒ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ØŸ",
            definition: "Ø§Ø³Ù…Ùƒ Ù‡Ùˆ Ù‡ÙˆÙŠØªÙƒØŒ Ø§ÙƒØªØ¨Ù‡ Ø¨ÙØ®Ø± ÙˆØ§Ø¹ØªØ²Ø§Ø²",
       why: "Ù„Ù…Ø§Ø°Ø§ ØªÙ‡ØªÙ… Ø¨Ø¨Ù†Ø§Ø¡ Ø±Ø¤ÙŠØ© Ù„Ø­ÙŠØ§ØªÙƒØŸ Ù…Ø§ Ø§Ù„Ø°ÙŠ Ø³ØªØ­Ù‚Ù‚Ù‡ Ø¨ÙˆØ¬ÙˆØ¯ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø¤ÙŠØ©ØŸ",
            wish: "Ù„Ø§ ØªØ¶Ø¹ Ø­Ø¯ÙˆØ¯Ø§Ù‹ Ù„Ø£Ø­Ù„Ø§Ù…ÙƒØŒ Ø§ÙƒØªØ¨ ÙƒÙ„ Ù…Ø§ ØªØ·Ù…Ø­ Ø¥Ù„ÙŠÙ‡ Ø¯ÙˆÙ† Ø®ÙˆÙ",
            skills: "ÙƒÙ„ Ø´Ø®Øµ Ù„Ø¯ÙŠÙ‡ Ù…ÙˆØ§Ù‡Ø¨ ÙØ±ÙŠØ¯Ø©ØŒ Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ØªÙ…ÙŠØ²ÙƒØŸ",
            needs: "Ù…Ø§ Ø§Ù„Ø¯Ø¹Ù… Ø£Ùˆ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬Ù‡Ø§ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ø­Ù„Ø§Ù…ÙƒØŸ",
            values: "Ù…Ø§ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„ØªÙŠ Ù„Ù† ØªØªØ®Ù„Ù‰ Ø¹Ù†Ù‡Ø§ Ø£Ø¨Ø¯Ø§Ù‹ØŸ Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ¤Ù…Ù† Ø¨Ù‡ Ù‚Ù„Ø¨ÙƒØŸ",
            satisfaction: "ØªØ®ÙŠÙ„ Ù†ÙØ³Ùƒ ÙˆÙ‚Ø¯ Ø­Ù‚Ù‚Øª ÙƒÙ„ Ù…Ø§ ØªØªÙ…Ù†Ù‰ØŒ ÙƒÙŠÙ Ø³ÙŠÙƒÙˆÙ† Ø´Ø¹ÙˆØ±ÙƒØŸ"
        };

        const youtubeVideos = {
            part1: "https://www.youtube.com/embed/JQ4bvJIqUxY",
            part2: "https://www.youtube.com/embed/bgxOquTzAfo",
            part3: "https://www.youtube.com/embed/tDqf4SMtrR0",
            part4: "https://www.youtube.com/embed/w-SbMhgik1c",
            part5: "https://www.youtube.com/embed/_uYP8zNwz1g",
            part6: "https://www.youtube.com/embed/vP2mqFE1HTI",
            part7: "https://www.youtube.com/embed/H21Ptqp7TEc",
            part8: "https://www.youtube.com/embed/wlwCOUewfD4"
        };

        const steps = [
            welcomeScreen,
            introVision,
            whyVision,
            buildWishesStep,
            buildSkillsStep,
            buildNeedsStep,
            buildValuesStep,
            buildSatisfactionStep,
            finalPreviewStep,
            finalScreen
        ];

        function welcomeScreen() {
            app.innerHTML = `
                <div class="cover">
                    <h1 class="pulse">Ø£Ù†Ø§ ... Ø¥Ù†Ø³Ø§Ù† Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...</h1>
                    <button onclick="nextStep()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø­Ù„Ø©</button>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
        }

        function introVision() {
            app.innerHTML = `
                <div class="cover">
                    <h2>Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©ØŸ</h2>
                    <div class="inspiration">${motivationalPhrases.definition}</div>
                    <input type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ" oninput="state.userData.name = this.value">
                    <div class="inspiration">${motivationalPhrases.name}</div>
                    <textarea placeholder="Ù…Ø§ ØªØ¹Ø±ÙŠÙÙƒ Ù„Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©ØŸ" oninput="state.userData.definition = this.value"></textarea>
                    <iframe class="youtube-video" src="${youtubeVideos.part1}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    <button id="nextBtn" style="display:none" onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', showNext);
        }

        function whyVision() {
            app.innerHTML = `
                <div class="cover">
                    <h2>Ù„Ù…Ø§Ø°Ø§ Ø¨Ø±Ø£ÙŠÙƒ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø±Ø¤ÙŠØ© Ø´Ø®ØµÙŠØ©ØŸ</h2>
                    <div class="inspiration">${motivationalPhrases.why}</div>
                    <textarea placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§" oninput="state.userData.why = this.value"></textarea>
                    <iframe class="youtube-video" src="${youtubeVideos.part2}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    <button id="nextBtn" style="display:none" onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', showNext);
        }

        function buildWishesStep() {
            app.innerHTML = `
                <div class="cover">
                    <iframe class="youtube-video" src="${youtubeVideos.part3}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    <div id="wishesArea" class="hidden">
                        <h2>Ù…Ø§ Ø§Ù„Ø£Ù…Ù†ÙŠØ§Øª Ø§Ù„ØªÙŠ ØªØ·Ù…Ø­ Ø£Ù† ØªÙƒÙˆÙ† Ø¹Ù„ÙŠÙ‡Ø§ØŸ</h2>
                        <div class="inspiration">${motivationalPhrases.wish}</div>
                        <div id="wishesContainer">
                            ${state.userData.wishes.length > 0 ? state.userData.wishes.map((wish, index) => `
                                <div class="wish-item" data-index="${index}">
                                    <div class="wish-title">Ø§Ù„Ø£Ù…Ù†ÙŠØ© ${index + 1}</div>
                                    <textarea placeholder="Ø§ÙƒØªØ¨ Ø£Ù…Ù†ÙŠØªÙƒ Ù‡Ù†Ø§" oninput="state.userData.wishes[${index}].text = this.value">${wish.text}</textarea>
                                    <button onclick="removeWish(${index})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù Ø§Ù„Ø£Ù…Ù†ÙŠØ©</button>
                                </div>
                            `).join('') : ''}
                        </div>
                        <button onclick="addNewWish()" class="small-btn" style="background-color: #86CDBB;">+ Ø£Ø¶Ù Ø£Ù…Ù†ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
                        <button onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                    </div>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', revealWishesForm);
        }

        function addNewWish() {
            const newWish = { text: "", skills: [] };
            state.userData.wishes.push(newWish);
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            const wishesContainer = document.getElementById("wishesContainer");
            const index = state.userData.wishes.length - 1;
            
            const div = document.createElement("div");
            div.className = "wish-item";
            div.dataset.index = index;
            div.innerHTML = `
                <div class="wish-title">Ø§Ù„Ø£Ù…Ù†ÙŠØ© ${index + 1}</div>
                <textarea placeholder="Ø§ÙƒØªØ¨ Ø£Ù…Ù†ÙŠØªÙƒ Ù‡Ù†Ø§" oninput="state.userData.wishes[${index}].text = this.value"></textarea>
                <button onclick="removeWish(${index})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù Ø§Ù„Ø£Ù…Ù†ÙŠØ©</button>
            `;
            
            wishesContainer.appendChild(div);
        }

        function removeWish(index) {
            state.userData.wishes.splice(index, 1);
            const container = document.getElementById("wishesContainer");
            const item = container.querySelector(`[data-index="${index}"]`);
            if (item) container.removeChild(item);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙ‡Ø§Ø±Ø³ Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©
            const remainingItems = container.querySelectorAll(".wish-item");
            remainingItems.forEach((item, newIndex) => {
                item.dataset.index = newIndex;
                const title = item.querySelector(".wish-title");
                if (title) title.textContent = `Ø§Ù„Ø£Ù…Ù†ÙŠØ© ${newIndex + 1}`;
                
                // ØªØ­Ø¯ÙŠØ« Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ­Ø°Ù Ø§Ù„Ø£Ù…Ù†ÙŠØ©
                const textarea = item.querySelector("textarea");
                if (textarea) {
                    textarea.oninput = (e) => {
                        state.userData.wishes[newIndex].text = e.target.value;
                    };
                }
                
                const deleteBtn = item.querySelector("button");
                if (deleteBtn) {
                    deleteBtn.onclick = () => removeWish(newIndex);
                }
            });
        }

        function revealWishesForm() {
            if (state.userData.wishes.length === 0) {
                addNewWish();
            }
            document.getElementById("wishesArea").classList.remove("hidden");
        }

        function buildSkillsStep() {
            app.innerHTML = `
                <div class="cover">
                    <iframe class="youtube-video" src="${youtubeVideos.part4}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    <div id="skillsArea" class="hidden">
                        <h2>Ù…Ø§ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ØªÙ…ØªÙ„ÙƒÙ‡Ø§ Ù„ÙƒÙ„ Ø£Ù…Ù†ÙŠØ©ØŸ</h2>
                        <div class="inspiration">${motivationalPhrases.skills}</div>
                        <div id="skillsContainer">
                            ${state.userData.wishes.map((wish, wishIndex) => `
                                <div class="wish-item">
                                    <div class="wish-title">${wish.text || "Ø£Ù…Ù†ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†"}</div>
                                    <div id="skillsForWish${wishIndex}">
                                        ${wish.skills.map((skill, skillIndex) => `
                                            <div class="skill-input-container">
                                                <textarea placeholder="Ø§ÙƒØªØ¨ Ù…Ù‡Ø§Ø±Ø©" oninput="updateSkill(${wishIndex}, ${skillIndex}, this.value)">${skill}</textarea>
                                                <button onclick="removeSkill(${wishIndex}, ${skillIndex})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <button onclick="addNewSkill(${wishIndex})" class="small-btn" style="background-color: #86CDBB;">+ Ø£Ø¶Ù Ù…Ù‡Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                    </div>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', revealSkillsForm);
        }

        function addNewSkill(wishIndex) {
            if (!state.userData.wishes[wishIndex].skills) {
                state.userData.wishes[wishIndex].skills = [];
            }
            state.userData.wishes[wishIndex].skills.push("");
            
            // Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            const skillsContainer = document.getElementById(`skillsForWish${wishIndex}`);
            const skillIndex = state.userData.wishes[wishIndex].skills.length - 1;
            
            const div = document.createElement("div");
            div.className = "skill-input-container";
            div.innerHTML = `
                <textarea placeholder="Ø§ÙƒØªØ¨ Ù…Ù‡Ø§Ø±Ø©" oninput="updateSkill(${wishIndex}, ${skillIndex}, this.value)"></textarea>
                <button onclick="removeSkill(${wishIndex}, ${skillIndex})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
            `;
            
            skillsContainer.appendChild(div);
        }

        function updateSkill(wishIndex, skillIndex, value) {
            state.userData.wishes[wishIndex].skills[skillIndex] = value;
        }

        function removeSkill(wishIndex, skillIndex) {
            state.userData.wishes[wishIndex].skills.splice(skillIndex, 1);
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø£Ù…Ù†ÙŠØ© ÙÙ‚Ø·
            const skillsContainer = document.getElementById(`skillsForWish${wishIndex}`);
            skillsContainer.innerHTML = state.userData.wishes[wishIndex].skills.map((skill, index) => `
                <div class="skill-input-container">
                    <textarea placeholder="Ø§ÙƒØªØ¨ Ù…Ù‡Ø§Ø±Ø©" oninput="updateSkill(${wishIndex}, ${index}, this.value)">${skill}</textarea>
                    <button onclick="removeSkill(${wishIndex}, ${index})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function revealSkillsForm() {
            document.getElementById("skillsArea").classList.remove("hidden");
        }

        function buildNeedsStep() {
            app.innerHTML = `
                <div class="cover">
                    <iframe class="youtube-video" src="${youtubeVideos.part5}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    <div id="needsArea" class="hidden">
                        <h2>Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªØ­ØªØ§Ø¬Ù‡ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ù…Ù†ÙŠØ§ØªÙƒØŸ</h2>
                        <div class="inspiration">${motivationalPhrases.needs}</div>
                        <div id="needsContainer">
                            ${state.userData.wishes.map((wish, wishIndex) => `
                                <div class="wish-item">
                                    <div class="wish-title">${wish.text || "Ø£Ù…Ù†ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†"}</div>
                                    <div id="needsForWish${wishIndex}">
                                        ${((state.userData.needs[wishIndex] || [])).map((need, needIndex) => `
                                            <div class="skill-input-container">
                                                <textarea placeholder="Ø§ÙƒØªØ¨ Ø§Ø­ØªÙŠØ§Ø¬" oninput="updateNeed(${wishIndex}, ${needIndex}, this.value)">${need}</textarea>
                                                <button onclick="removeNeed(${wishIndex}, ${needIndex})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <button onclick="addNewNeed(${wishIndex})" class="small-btn" style="background-color: #86CDBB;">+ Ø£Ø¶Ù Ø§Ø­ØªÙŠØ§Ø¬ Ø¬Ø¯ÙŠØ¯</button>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                    </div>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', revealNeedsForm);
        }

        function addNewNeed(wishIndex) {
            if (!state.userData.needs[wishIndex]) {
                state.userData.needs[wishIndex] = [];
            }
            state.userData.needs[wishIndex].push("");
            
            const needsContainer = document.getElementById(`needsForWish${wishIndex}`);
            const needIndex = state.userData.needs[wishIndex].length - 1;
            
            const div = document.createElement("div");
            div.className = "skill-input-container";
            div.innerHTML = `
                <textarea placeholder="Ø§ÙƒØªØ¨ Ø§Ø­ØªÙŠØ§Ø¬" oninput="updateNeed(${wishIndex}, ${needIndex}, this.value)"></textarea>
                <button onclick="removeNeed(${wishIndex}, ${needIndex})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
            `;
            
            needsContainer.appendChild(div);
        }

        function updateNeed(wishIndex, needIndex, value) {
            if (!state.userData.needs[wishIndex]) {
                state.userData.needs[wishIndex] = [];
            }
            state.userData.needs[wishIndex][needIndex] = value;
        }

        function removeNeed(wishIndex, needIndex) {
            state.userData.needs[wishIndex].splice(needIndex, 1);
            
            const needsContainer = document.getElementById(`needsForWish${wishIndex}`);
            needsContainer.innerHTML = (state.userData.needs[wishIndex] || []).map((need, index) => `
                <div class="skill-input-container">
                    <textarea placeholder="Ø§ÙƒØªØ¨ Ø§Ø­ØªÙŠØ§Ø¬" oninput="updateNeed(${wishIndex}, ${index}, this.value)">${need}</textarea>
                    <button onclick="removeNeed(${wishIndex}, ${index})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function revealNeedsForm() {
            document.getElementById("needsArea").classList.remove("hidden");
        }

        function buildValuesStep() {
            app.innerHTML = `
                <div class="cover">
                    <iframe class="youtube-video" src="${youtubeVideos.part6}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    <div id="valuesArea" class="hidden">
                        <h2>Ù…Ø§ Ø§Ù„Ù‚ÙŠÙ… ÙˆØ§Ù„Ù…Ø¹ØªÙ‚Ø¯Ø§Øª Ø§Ù„ØªÙŠ ØªØ¯ÙØ¹ÙƒØŸ</h2>
                        <div class="inspiration">${motivationalPhrases.values}</div>
                        <div id="valuesContainer">
                            ${state.userData.wishes.map((wish, wishIndex) => `
                                <div class="wish-item">
                                    <div class="wish-title">${wish.text || "Ø£Ù…Ù†ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†"}</div>
                                    <div id="valuesForWish${wishIndex}">
                                        ${((state.userData.values[wishIndex] || [])).map((value, valueIndex) => `
                                            <div class="skill-input-container">
                                                <textarea placeholder="Ø§ÙƒØªØ¨ Ù‚ÙŠÙ…Ø© Ø£Ùˆ Ù…Ø¹ØªÙ‚Ø¯" oninput="updateValue(${wishIndex}, ${valueIndex}, this.value)">${value}</textarea>
                                                <button onclick="removeValue(${wishIndex}, ${valueIndex})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
                                            </div>
                                        `).join('')}
                                    </div>
                                    <button onclick="addNewValue(${wishIndex})" class="small-btn" style="background-color: #86CDBB;">+ Ø£Ø¶Ù Ù‚ÙŠÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                    </div>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', revealValuesForm);
        }

        function addNewValue(wishIndex) {
            if (!state.userData.values[wishIndex]) {
                state.userData.values[wishIndex] = [];
            }
            state.userData.values[wishIndex].push("");
            
            const valuesContainer = document.getElementById(`valuesForWish${wishIndex}`);
            const valueIndex = state.userData.values[wishIndex].length - 1;
            
            const div = document.createElement("div");
            div.className = "skill-input-container";
            div.innerHTML = `
                <textarea placeholder="Ø§ÙƒØªØ¨ Ù‚ÙŠÙ…Ø© Ø£Ùˆ Ù…Ø¹ØªÙ‚Ø¯" oninput="updateValue(${wishIndex}, ${valueIndex}, this.value)"></textarea>
                <button onclick="removeValue(${wishIndex}, ${valueIndex})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
            `;
            
            valuesContainer.appendChild(div);
        }

        function updateValue(wishIndex, valueIndex, value) {
            if (!state.userData.values[wishIndex]) {
                state.userData.values[wishIndex] = [];
            }
            state.userData.values[wishIndex][valueIndex] = value;
        }

        function removeValue(wishIndex, valueIndex) {
            state.userData.values[wishIndex].splice(valueIndex, 1);
            
            const valuesContainer = document.getElementById(`valuesForWish${wishIndex}`);
            valuesContainer.innerHTML = (state.userData.values[wishIndex] || []).map((value, index) => `
                <div class="skill-input-container">
                    <textarea placeholder="Ø§ÙƒØªØ¨ Ù‚ÙŠÙ…Ø© Ø£Ùˆ Ù…Ø¹ØªÙ‚Ø¯" oninput="updateValue(${wishIndex}, ${index}, this.value)">${value}</textarea>
                    <button onclick="removeValue(${wishIndex}, ${index})" class="small-btn" style="background-color: #E5554D;">Ø­Ø°Ù</button>
                </div>
            `).join('');
        }

        function revealValuesForm() {
            document.getElementById("valuesArea").classList.remove("hidden");
        }

        function buildSatisfactionStep() {
            app.innerHTML = `
                <div class="cover">
                    <iframe class="youtube-video" src="${youtubeVideos.part7}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    <div id="satisfactionArea" class="hidden">
                        <h2>ÙƒÙŠÙ Ø³ØªØ´Ø¹Ø± Ø¥Ø°Ø§ Ø­Ù‚Ù‚Øª Ø±Ø¤ÙŠØªÙƒØŸ</h2>
                        <div class="inspiration">${motivationalPhrases.satisfaction}</div>
                        <textarea placeholder="ØµÙ Ø´Ø¹ÙˆØ±Ùƒ Ø¹Ù†Ø¯ ØªØ­Ù‚ÙŠÙ‚ Ø±Ø¤ÙŠØªÙƒ" oninput="state.userData.satisfaction = this.value"></textarea>
                        <button onclick="nextStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
                    </div>
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', revealSatisfactionForm);
        }

        function revealSatisfactionForm() {
            document.getElementById("satisfactionArea").classList.remove("hidden");
        }

        function finalPreviewStep() {
            app.innerHTML = `
                <div class="cover">
                    <h2>Ø§Ø³ØªØ¹Ø¯ Ù„Ø±Ø¤ÙŠØ© Ø±Ø¤ÙŠØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h2>
                    <p>Ø´Ø§Ù‡Ø¯ Ù‡Ø°Ø§ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®ØªØ§Ù…ÙŠ Ù‚Ø¨Ù„ Ø£Ù† ØªØ±ÙŠ Ù…Ù„Ø®Øµ Ø±Ø¤ÙŠØªÙƒ</p>
                    <iframe class="youtube-video" src="${youtubeVideos.part8}?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen id="video"></iframe>
                    
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
            setupYouTubePlayer('video', showFinalScreen);
        }

        function showFinalScreen() {
            const btn = document.createElement("button");
            btn.textContent = "Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø¤ÙŠØ©";
            btn.onclick = nextStep;
            btn.style.backgroundColor = "#247EB1";
            btn.style.color = "white";
            btn.style.padding = "15px 30px";
            btn.style.fontSize = "18px";
            btn.style.borderRadius = "12px";
            btn.style.marginTop = "20px";
            document.querySelector(".cover").appendChild(btn);
        }

        function finalScreen() {
            // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
            let finalVision = `Ø£Ù†Ø§ ${state.userData.name || "..."}ØŒ Ø£Ø¤Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ø¤ÙŠØ© Ù‡ÙŠ: ${state.userData.definition || "..."}.\n\n`;
            finalVision += `Ø£Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø±Ø¤ÙŠØ© Ù„Ø£Ù†Ù‡Ø§: ${state.userData.why || "..."}.\n\n`;
            
            finalVision += "Ø£Ù…Ù†ÙŠØ§ØªÙŠ:\n";
            state.userData.wishes.forEach((wish, index) => {
                finalVision += `${index + 1}. ${wish.text || "..."}\n`;
                if (wish.skills && wish.skills.length > 0) {
                    finalVision += `   Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª: ${wish.skills.join("ØŒ ")}\n`;
                }
                if (state.userData.needs[index] && state.userData.needs[index].length > 0) {
                    finalVision += `   Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª: ${state.userData.needs[index].join("ØŒ ")}\n`;
                }
                if (state.userData.values[index] && state.userData.values[index].length > 0) {
                    finalVision += `   Ø§Ù„Ù‚ÙŠÙ…: ${state.userData.values[index].join("ØŒ ")}\n`;
                }
                finalVision += "\n";
            });
            
            finalVision += `\nÙˆØ³Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø±Ø¶Ø§ Ø¹Ù†Ø¯Ù…Ø§: ${state.userData.satisfaction || "..."}`;
            
            state.userData.finalVision = finalVision;
            
            const emailBody = `
Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©:
${finalVision}

Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø¤ÙŠØ©:
${state.userData.shortSummary || "Ù„Ù… ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ù…Ù„Ø®Øµ"}

ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø¤ÙŠØ©:
${generateVisionTable()}
            `;
            
            app.innerHTML = `
                <div class="cover">
                    <h2>Ø±Ø¤ÙŠØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©:</h2>
                    <div class="summary-box">
                        <div class="summary-title">Ø§Ù„Ø¢Ù†ØŒ Ù†Ø±ÙŠØ¯ Ù…Ù†Ùƒ ØªÙ„Ø®ÙŠØµ Ø±Ø¤ÙŠØªÙƒ ÙÙŠ Ø¬Ù…Ù„Ø© Ø£Ùˆ Ø¬Ù…Ù„ØªÙŠÙ† Ù‚ØµÙŠØ±ØªÙŠÙ†:</div>
                        <textarea class="summary-input" placeholder="Ø§ÙƒØªØ¨ ØªÙ„Ø®ÙŠØµÙƒ Ù‡Ù†Ø§..." oninput="state.userData.shortSummary = this.value"></textarea>
                    </div>
                    
                    <h3>Ù…Ù„Ø®Øµ Ø±Ø¤ÙŠØªÙƒ:</h3>
                    ${generateVisionTable()}
                    
                    
<div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
    <button onclick="exportToWord()" style="background-color: #934798;">ğŸ’¾ Ø­ÙØ¸ ÙƒÙ€ Word</button>
</div>

                    
           
                <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025</div></div>`;
        }

        
        function generateVisionTable() {
            let tableHTML = '<div class="summary-box">';
            tableHTML += '<h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø¤ÙŠØ©:</h3>';
            tableHTML += '<p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ' + (state.userData.name || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ") + '</p>';
            
            state.userData.wishes.forEach((wish, index) => {
                let wishText = '<p><strong>Ø§Ù„Ø£Ù…Ù†ÙŠØ© ' + (index + 1) + ':</strong> ';
                wishText += (wish.text || "Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†") + '. ';
                
                if (wish.skills && wish.skills.length > 0) {
                    wishText += 'Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª: ' + wish.skills.join("ØŒ ") + '. ';
                }
                if (state.userData.needs[index] && state.userData.needs[index].length > 0) {
                    wishText += 'Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª: ' + state.userData.needs[index].join("ØŒ ") + '. ';
                }
                if (state.userData.values[index] && state.userData.values[index].length > 0) {
                    wishText += 'Ø§Ù„Ù‚ÙŠÙ…: ' + state.userData.values[index].join("ØŒ ") + '. ';
                }
                wishText += '</p>';
                tableHTML += wishText;
            });
            
            tableHTML += '<p><strong>Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ø±Ø¶Ø§:</strong> ' + (state.userData.satisfaction || "...") + '</p>';
            
            tableHTML += '</div>';
            return tableHTML;
        }
    

        function downloadVision() {
            const { finalVision, shortSummary } = state.userData;
            const content = `
Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©:
${finalVision}

Ø§Ù„ØªÙ„Ø®ÙŠØµ:
${shortSummary || "Ù„Ù… ÙŠØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ù…Ù„Ø®Øµ"}

ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø¤ÙŠØ©:
${generateVisionTable().replace(/<[^>]*>/g, '').replace(/&nbsp;/g, ' ')}
            `;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Ø±Ø¤ÙŠØªÙŠ-Ø§Ù„Ø´Ø®ØµÙŠØ©.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function setupYouTubePlayer(videoId, callback) {
            // ØªØ­Ù…ÙŠÙ„ API ÙŠÙˆØªÙŠÙˆØ¨ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø­Ù…Ù„Ù‹Ø§
            if (!window.YT) {
                const tag = document.createElement('script');
                tag.src = "https://www.youtube.com/iframe_api";
                const firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
            }

            // Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ API
            const checkYT = setInterval(() => {
                if (window.YT && YT.loaded) {
                    clearInterval(checkYT);
                    initPlayer();
                }
            }, 100);

            function initPlayer() {
                const player = new YT.Player(videoId, {
                    events: {
                        'onStateChange': onPlayerStateChange
                    }
                });

                function onPlayerStateChange(event) {
                    if (event.data == YT.PlayerState.ENDED) {
                        callback();
                    }
                }
            }
        }

        function showNext() {
            const nextBtn = document.getElementById("nextBtn");
            if (nextBtn) nextBtn.style.display = "inline-block";
        }

        function nextStep() {
            state.currentStep++;
            steps[state.currentStep]();
        }

        steps[0]();
    </script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script>
    function exportToWord() {
        const header = `
            <html xmlns:o='urn:schemas-microsoft-com:office:office'
                  xmlns:w='urn:schemas-microsoft-com:office:word'
                  xmlns='http://www.w3.org/TR/REC-html40'>
            <head>
                <meta charset='utf-8'>
                <title>Ø±Ø¤ÙŠØªÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ©</title>
                <style>
                    body {
                        font-family: 'Arial', sans-serif;
                        line-height: 1.6;
                        color: #333;
                        direction: rtl;
                        padding: 20px;
                    }
                    .header {
                        text-align: center;
                        margin-bottom: 30px;
                        border-bottom: 2px solid #247EB1;
                        padding-bottom: 15px;
                    }
                    h1 {
                        color: #247EB1;
                        font-size: 24pt;
                        margin-bottom: 10px;
                    }
                    h2 {
                        color: #934798;
                        font-size: 18pt;
                        margin-top: 25px;
                        border-right: 4px solid #934798;
                        padding-right: 10px;
                    }
                    .vision-section {
                        background-color: #f9f9f9;
                        border-radius: 8px;
                        padding: 15px;
                        margin: 15px 0;
                        border-right: 3px solid #F8CD71;
                    }
                    .wish-item {
                        margin-bottom: 20px;
                        padding: 10px;
                        background-color: #f0f8ff;
                        border-radius: 5px;
                    }
                    .wish-title {
                        font-weight: bold;
                        color: #E5554D;
                        margin-bottom: 5px;
                    }
                    .footer {
                        text-align: center;
                        margin-top: 30px;
                        font-size: 10pt;
                        color: #777;
                        border-top: 1px solid #ddd;
                        padding-top: 10px;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin: 15px 0;
                    }
                    th {
                        background-color: #247EB1;
                        color: white;
                        padding: 10px;
                        text-align: right;
                    }
                    td {
                        padding: 8px;
                        border-bottom: 1px solid #ddd;
                        text-align: right;
                    }
                </style>
            </head>
            <body>
        `;

        const footer = `
                <div class="footer">
                    ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ø£Ø¯Ø§Ø© "Ø±Ø¤ÙŠØªÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ©" - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„ÙØ±ÙŠÙ‚ Ø¯Ù„ÙŠÙ„ 2025
                </div>
            </body>
            </html>
        `;

        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Word Ù…Ø¹ ØªÙ†Ø³ÙŠÙ‚ Ø§Ø­ØªØ±Ø§ÙÙŠ
        let content = `
            <div class="header">
                <h1>Ø±Ø¤ÙŠØªÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ©</h1>
                <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleDateString('ar-EG')}</p>
            </div>

            <div class="vision-section">
                <h2>Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</h2>
                <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${state.userData.name || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}</p>
                <p><strong>ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø±Ø¤ÙŠØ©:</strong> ${state.userData.definition || "..."}</p>
                <p><strong>Ø£Ù‡Ù…ÙŠØ© Ø§Ù„Ø±Ø¤ÙŠØ©:</strong> ${state.userData.why || "..."}</p>
            </div>
        `;

        if (state.userData.shortSummary) {
            content += `
                <div class="vision-section">
                    <h2>Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø¤ÙŠØ©</h2>
                    <p>${state.userData.shortSummary}</p>
                </div>
            `;
        }

        content += `<div class="vision-section"><h2>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø¤ÙŠØ©</h2>`;

        state.userData.wishes.forEach((wish, index) => {
            content += `
                <div class="wish-item">
                    <div class="wish-title">Ø§Ù„Ø£Ù…Ù†ÙŠØ© ${index + 1}: ${wish.text || "Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†"}</div>
                    ${wish.skills && wish.skills.length > 0 ? 
                        `<p><strong>Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª:</strong> ${wish.skills.join("ØŒ ")}</p>` : ''}
                    ${state.userData.needs[index] && state.userData.needs[index].length > 0 ? 
                        `<p><strong>Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª:</strong> ${state.userData.needs[index].join("ØŒ ")}</p>` : ''}
                    ${state.userData.values[index] && state.userData.values[index].length > 0 ? 
                        `<p><strong>Ø§Ù„Ù‚ÙŠÙ…:</strong> ${state.userData.values[index].join("ØŒ ")}</p>` : ''}
                </div>
            `;
        });

        content += `</div>`;

        if (state.userData.satisfaction) {
            content += `
                <div class="vision-section">
                    <h2>Ù…Ø´Ø§Ø¹Ø± Ø§Ù„Ø±Ø¶Ø§</h2>
                    <p>${state.userData.satisfaction}</p>
                </div>
            `;
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ù…Ù„Ø®Øµ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
        content += `
            <div class="vision-section">
                <h2>Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø¤ÙŠØ©</h2>
                <table>
                    <tr>
                        <th>Ø§Ù„Ø¹Ù†ØµØ±</th>
                        <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
                    </tr>
                    <tr>
                        <td>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù…Ù†ÙŠØ§Øª</td>
                        <td>${state.userData.wishes.length}</td>
                    </tr>
                    <tr>
                        <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</td>
                        <td>${state.userData.wishes.reduce((acc, wish) => acc + (wish.skills ? wish.skills.length : 0), 0)}</td>
                    </tr>
                    <tr>
                        <td>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</td>
                        <td>${new Date().toLocaleDateString('ar-EG')}</td>
                    </tr>
                </table>
            </div>
        `;

        const source = header + content + footer;
        const blob = new Blob(['\ufeff', source], {
            type: 'application/msword'
        });
        saveAs(blob, `Ø±Ø¤ÙŠØªÙŠ-Ø§Ù„Ø´Ø®ØµÙŠØ©-${state.userData.name || 'Ù…Ø¬Ù‡ÙˆÙ„'}.doc`);
    }

    function printVision() {
        const original = document.body.innerHTML;
        const visionHTML = document.querySelector('.cover').outerHTML;
        document.body.innerHTML = visionHTML;
        window.print();
        document.body.innerHTML = original;
    }
</script>

</body>

</html>
